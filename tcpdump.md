# TCPDUMP

Tcpdump é uma ferramenta opensource utilizada para realizar captura e análise de pacotes na rede. Pode ser utilizada no monitoramento e manutenção de uma rede, e até mesmo em uma análise forense durante uma resposta a incidente. É muito eficiênte para ajudar a entender a fundo o funcionamento da pilha de protocolos TCP/IP.

Ele é uma ferramenta de linha de comando que usa a biblioteca libpcap para realiar a captura de pacotes.

Para instalar o tcpdump no linux basta rodar os comandos a seguir, conforme usa distribuições:

    # apt-get install tcpdump (Debian e distros baseadas)

    # yum install tcpdump (RedHat e distros baseadas)

Abaixo segue a sintaxe:

tcpdump [opções]

    -i interface
 Especificar a interface de rede a partir da qual o tráfego será capturado. Se for usado o parâmetro any, o programa irá capturar pacotes em todas as interfaces ativas na máquina.

### -c num
Sair após capturar num pacotes

### -D
Mostrar uma lista das interfaces de rede no sistema que estão disponíveis e nas quais o tcpdump pode capturar pacotes.

### -n
Não realizar a resolução de nomes

### -r arquivo
Ler os pacotes a partir de arquivo, o qual foi criado anteriormente com a opção -w

### -w arquivo
Escrever os pacotes em arquivo, emvez de mostrá-los formatados na saída padrão

### -X
Mostrar o conteúdo do pacote em Hexadecimal e ASCII; se for usado 

### -XX, 
também mostrará o cabeçalho Ethernet.

### src IP/Nome
Capturar pacotes originados apenas do host com o IP ou hostname especificado.

### dst IP/Nome
Capturar pacotes destinado apenas ao host com o IP ou hostname especificado.

### greater BYTES, > BYTES
Capturar apenas pacotes que sejam maiores que BYTES

### less BYTES, < BYTES
Capturar apenas pacotes que sejam menores que BYTES

### port NUM
Trabalhar com pacotes destinados ou originados de uma porta específica NUM

### portrange A-B
Capturar pacotes cujas portas estejam no intervalo entre A e B.

### A and B
Capturar os pacotes somente se satisfizerem às condições A e B simultaneamente

### A or B
Capturar os pacotes se satisfizerem à condição A ou à condição B, ou a ambas

### not A
Capturar os pacotes que não satisfaçam à condição A.

### -v
Produzir uma saída ligeiramente mais verbosa. Algumas informações adicionais são exibidas, tais como os valores dos campos TTL, Identificação, Comprimento Total e Opções do pacote IP.

### -vv
Saída mais verbosa do que a opção -v. Por exemplo, pacotes SMB são completamente decodificados.

## Exemplos de Uso

### 1 - Iniciar tcpdump de maneira simples 

    #tcpdump 

### 2- Fazer captura em um arquivo em uma unica interface

    #tcpdump -v (verbose) -i (interface) -w nome.pcap

### 3 - Fazer a captura em modo verbose em um arquivo

    #tcpdump -v -i eth0 icmp -w icmp.pcap

### 4- Lendo o arquivo capturado

    #tcpdump -r icmp.pcap

- Opção -r é para ler o arquivo capturado

### 5 - Com a opção -n , mostra mais detalhes, como os endereços ips

    #tcpdump -nr icmp.pcap


### 6 - Mode Verbose -v traz mais detalhes

    #tcpdump -vnr icmp.pcap

### 7 - Com opção -e é possível ver detalhes sobre o ethernet

    #tcpdump -venr icmp.pcap

 