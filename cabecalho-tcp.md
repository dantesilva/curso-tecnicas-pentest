# Funcionamento do cabeçalho TCP

<img src="cabecalho-tcp.png" alt="cabeçalho tcp" width="70%">
<p></p>
O protocolo TCP especifica três fases durante uma conexão: Estabelecimento da ligação, transferência e termino. O estabelecimento é feito em três passos, ao passo que o término é feito em quatro.

## Estabelecimento da conexão:

Para estabelecer a conexão, o TCP usa um handshake (aperto de mão) de três vias. Para estabelecer o aperto de mão de três vias é necessário:

## SYN
- A abertura ativa é realizada por meio de envio de um SYN pelo cliente ao servidor. 

## SYN-ACK 
- Em resposta o servidor responde com um SYN-ACK

## ACK
- O cliente envia um ACK de volta para o servidor. Neste ponto cliente e servidor receberam um reconhecimento da conexão... Com isso uma comunicação full-duplex é estabelecida.
<p></p>
<center><img src="syn.png" width="30%" ></center>

## Termino da ligação

A  fase de encerramento da sessão TCP é um processo de quatro fases, em que cada interlocutor responsabiliza-se pelo encerramento do seu lado da ligação. Quando um deles pretende finalizar a sessão, envia um pacote com a flag FIN ativa, ao qual deverá receber uma resposta ACK. Por sua vez, o outro interlocutor irá proceder da mesma forma, enviando um FIN ao qual deverá ser respondido um ACK.

Pode ocorrer, no entanto, que um dos lados não encerre a sessão. Chama-se a este tipo de evento de conexão semi-aberta. O lado que não encerrou a sessão poderá continuar a enviar informação pela conexão, mas o outro lado não. <p></p>

<img src="TCP_termination.png">

## TCP flags

- SYN (synchronize): Pacotes que são suados para iniciar uma conexão

- ACK (Reconhecimento): Pacotes usados para confirmar que os pacotes de dados foram recebidos;

- RST (Reset): Conexão está baixa ou talvez os serviços não estejam aceitando conexões;

- FIN (Finish): Conexão está sendo fechada. Tanto o remetente como o receptor enviam um um pacote FIN para terminar a conexão

- PSH (Push): Indica que os dados devem ser repassados direto para o aplicatico em vez de serem bufferizados;

- URG (Urgente): Indica que os dados recebidos, devem ser processados imediatamente pela pilha TCP